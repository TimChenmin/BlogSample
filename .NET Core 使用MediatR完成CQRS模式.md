# 前言

**CQRS**(**Command Query Responsibility Segregation**)命令查询职责分离模式，它主要从我们业务系统中进行分离出我们(Command 增、删、改)和（Query 查）,
同时他可以明确的区分我们每一个动作向我们的请求模型和响应模型.从而降低了我们系统的复杂性.
通常情况我们使用同一数据模型进行我们数据的查询和修改,这是一个非常简单的CURD，在一些复杂的应用程序中，这种方法会变的难以操作，例如在读取方面应用程序可能会存在大量的查询，
返回具有不同的数据传输对象（DTO）,对象映射可能会变的非常复杂，在写入方面，模型可能实施复杂的验证和业务逻辑.结果导致模型太多操作，整体变的相当得复杂.

如下图所示:

![](https://imgkr.cn-bj.ufileos.com/af3e85fb-21cb-4de7-884f-027c613e2ac9.png)




# MediatR示例

Install MediatR 
```
PM> Install-Package MediatR
```

```csharp
    public class CreateOrderRequestModel: 
        IRequest<string>
    {
        public string UserId { get; set; }
        public string CardNumber { get; set; }
    }
```

```csharp
    public class GetOrderByIdRequestModel:IRequest<string>
    {
        public string OrderId { get; set; }
    }
```


```csharp
    public class CreateOrderCommandHandler
        : IRequestHandler<CreateOrderRequestModel, string>
    {
        public Task<string> Handle(CreateOrderRequestModel request, CancellationToken cancellationToken)
        {
            //do something...
            return Task.FromResult(request.UserId);
        }
    }

```

```csharp
    public class GetOrderByIdQueryHandler :
        IRequestHandler<GetOrderByIdRequestModel, string>
    {
        public Task<string> Handle(GetOrderByIdRequestModel request, CancellationToken cancellationToken)
        {
            //do something
            return Task.FromResult(request.OrderId);
        }
    }
```

